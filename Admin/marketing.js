// Arquivo: marketing.js

let marketingSectionInitialized = false;
const MARKETING_COLLECTION = "scheduled_posts";

// --- BANCO DE IDEIAS CRIATIVAS (100 EXEMPLOS) ---
const CAPTION_IDEAS = [
    // Semanais e Dias Espec√≠ficos (7)
    { title: "Segunda-feira (Come√ßo da Semana)", caption: "Segunda-feira pede uma motiva√ß√£o extra! Que tal come√ßar a semana com o p√© direito e uma pizza deliciosa? Pe√ßa a sua e transforme o in√≠cio da semana. #SegundaFeira #PizzaNight #ComecoDeSemana" },
    { title: "Ter√ßa-feira (Promo√ß√£o)", caption: "TER√áA EM DOBRO! üçïüçï Compre uma pizza de [Sabor] e a segunda sai com 50% de desconto! Marque quem vai dividir essa com voc√™. Promo√ß√£o v√°lida somente hoje! #TercaEmDobro #PromocaoDePizza #Delivery" },
    { title: "Quarta-feira (Futebol)", caption: "Quarta √© dia de futebol e pizza! ‚öΩüçï J√° garantiu a sua para o jogo de hoje? Fa√ßa seu pedido e receba no conforto do seu sof√°. #FutebolComPizza #DiaDeJogo #Pizzaria" },
    { title: "Quinta-feira (TBT da Fome)", caption: "#TBT daquela fome de quinta que s√≥ uma D'Italia resolve. Qual sabor te d√° mais saudade? Conta pra gente! #TBT #QuintaFeira #Fome" },
    { title: "Sextou!", caption: "SEXTOU! üôå O fim de semana chegou e a sua √∫nica preocupa√ß√£o deveria ser qual sabor de pizza pedir. Deixa a janta com a gente! #Sextou #FimDeSemana #Pizza" },
    { title: "S√°bado √† Noite", caption: "A noite de s√°bado foi feita para momentos especiais. E nada mais especial que uma pizza quentinha com quem voc√™ ama. ‚ù§Ô∏èüçï #SabadoANoite #PizzaComAmor #Momentos" },
    { title: "Domingo (Pregui√ßa Boa)", caption: "Domingo √© o dia oficial da pregui√ßa. Cozinhar pra qu√™? Pe√ßa sua pizza favorita e curta o fim do dia sem preocupa√ß√µes. #Domingo #Preguica #PizzaEmCasa" },
    
    // Engajamento e Intera√ß√£o (10)
    { title: "Enquete de Sabores", caption: "BATALHA DE SABORES! ‚öîÔ∏è Qual vence essa disputa: Calabresa ou Quatro Queijos? Vote nos coment√°rios e vamos ver qual √© a favorita da galera! #BatalhaDeSabores #Enquete #TeamCalabresa #TeamQuatroQueijos" },
    { title: "Complete a Frase", caption: "Complete a frase: 'Uma pizza perfeita precisa ter ____'. Queremos saber o que n√£o pode faltar na sua! As respostas mais criativas ganham um cupom! üòâ #CompleteAFrase #PizzaPerfeita #Interacao" },
    { title: "Foto do Cliente (Repost)", caption: "A gente AMA ver voc√™s felizes com nossas pizzas! ‚ù§Ô∏è Essa foto incr√≠vel √© do(a) @[marcar cliente]. Fa√ßa como ele(a), poste sua foto com a #NossaHashtag e apare√ßa aqui! #ClienteFeliz #PizzaLovers" },
    { title: "Dica de Harmoniza√ß√£o", caption: "Dica do chef: nossa pizza de [Sabor] harmoniza perfeitamente com um [Tipo de Vinho/Cerveja]. Que tal experimentar essa combina√ß√£o hoje? üç∑üç∫ #DicaDoChef #Harmonizacao #PizzaEVinho" },
    { title: "Meme de Pizza", caption: "Eu depois de comer a primeira fatia da pizza da D'Italia. (Use uma imagem de meme popular). Quem mais se identifica? üòÇ #Meme #PizzaMeme #Humor" },
    { title: "Pizza para Cada Signo", caption: "A pizza de cada signo! ‚ôà √Åries: apimentada. ‚ôâ Touro: 4 queijos. ‚ôä G√™meos: metade de cada. Qual √© a sua? Comenta a√≠! #Astrologia #Signos #PizzaDosSignos" },
    { title: "Desafio: Montar a Pizza", caption: "Se voc√™ pudesse montar uma pizza com 3 ingredientes, quais seriam? Deixe sua combina√ß√£o nos coment√°rios! Quem sabe ela n√£o vira um sabor especial por um dia? ü§î #Desafio #MonteSuaPizza" },
    { title: "Descreva em 3 Emojis", caption: "Descreva a sua fome de pizza agora mesmo usando apenas 3 emojis! Os nossos s√£o: ü§§üèÉ‚Äç‚ôÇÔ∏èüçï. Valendo! #EmojiChallenge #FomeDePizza" },
    { title: "Primeira Letra do Nome", caption: "Qual sabor de pizza voc√™ pediria usando apenas a primeira letra do seu nome? Deixe sua criatividade fluir nos coment√°rios! #Brincadeira #PizzaChallenge" },
    { title: "Essa ou Aquela?", caption: "Guerra de Cl√°ssicos: Borda tradicional ou Borda Recheada? N√£o vale ficar em cima do muro! Vote! #BatalhaDeBordas #PizzaLovers #Enquete" },

    // Foco no Produto e Vendas (12)
    { title: "Foco na Borda Recheada", caption: "Voc√™ j√° provou nossa borda recheada de [Sabor da Borda]? √â um espet√°culo √† parte! Pe√ßa a sua com esse upgrade de sabor. ü§§ #BordaRecheada #Queijo #ExtraSabor" },
    { title: "Lan√ßamento de Sabor", caption: "NOVO SABOR NA √ÅREA! ‚ú® Apresentamos a incr√≠vel pizza de [Nome do Novo Sabor]. Uma combina√ß√£o de [Ingredientes] que vai te surpreender. Pe√ßa a sua e conte pra gente o que achou! #Lancamento #NovoSabor" },
    { title: "A Mais Pedida", caption: "Essa √© a campe√£ de pedidos! üèÜ A nossa pizza de [Sabor Mais Pedido] √© a prova de que o cl√°ssico nunca sai de moda. J√° pediu a sua hoje? #AMaisPedida #Campe√£DeVendas #Sucesso" },
    { title: "Foco em Bebidas", caption: "Pizza boa pede uma bebida gelada! ü•§ J√° conferiu nossa sele√ß√£o de refrigerantes e sucos? Adicione sua bebida favorita ao pedido e deixe tudo perfeito. #BebidaGelada #PizzaEGuarana" },
    { title: "Benef√≠cios de Pedir em Casa", caption: "Vantagens de pedir D'Italia em casa: 1. N√£o precisa lavar lou√ßa. 2. Come de pijama. 3. Felicidade instant√¢nea. Precisa de mais motivos? üòâ #Delivery #Conforto #FicaEmCasa" },
    { title: "Foco no Queijo Puxando", caption: "Aquele momento que a gente vive pra ver. üßÄü§§ Marque algu√©m que precisa ver essa cena hoje! #QueijoPuxando #CheesePull #Satisfatorio" },
    { title: "Para os Indecisos", caption: "Na d√∫vida entre dois sabores? Pe√ßa uma pizza meio a meio e seja feliz em dobro! üòÑ #MeioAMeio #Indecisos #Solucao" },
    { title: "Cupom Rel√¢mpago (Stories)", caption: "CUPOM REL√ÇMPAGO! ‚ö° Os 10 primeiros que usarem o c√≥digo 'PIZZAFLASH' no nosso site ganham 15% de desconto. V√°lido s√≥ por 1 hora! CORRE! #CupomRelampago #Desconto" },
    { title: "Vegetariana do Dia", caption: "Quem disse que pizza vegetariana n√£o √© incr√≠vel? üå± Nossa [Nome da Pizza Veg] √© cheia de sabor e ingredientes frescos. J√° provou? #Vegetariana #PizzaVeg #SaborSemCarne" },
    { title: "Para os Amantes de Doce", caption: "Guarde um espacinho para a sobremesa! üòã Nossa pizza doce de [Sabor] √© o final perfeito para a sua refei√ß√£o. #PizzaDoce #Sobremesa #Chocolate" },
    { title: "A pedida pra galera", caption: "Vai reunir a galera? Pizza √© a resposta! Fa√ßa seu pedido em quantidade e garanta a alegria de todo mundo. Consulte nossos combos para grupos! #PizzaPraGalera #Amigos #Festa" },
    { title: "Calzone: O Tesouro Escondido", caption: "Voc√™ sabia que nosso card√°pio tem calzones incr√≠veis? √â a mesma qualidade da nossa pizza, mas com o recheio guardado a sete chaves. Pe√ßa o seu! #Calzone #Recheio #Segredo" },
    
    // Institucional e Bastidores (11)
    { title: "Bastidores (Ingredientes)", caption: "O segredo do nosso sabor est√° na qualidade. üçÖ Usamos apenas ingredientes frescos e selecionados para garantir que cada fatia seja inesquec√≠vel. #IngredientesFrescos #Qualidade #FeitoComAmor" },
    { title: "Hist√≥ria da Pizzaria", caption: "Voc√™ sabia? A D'Italia nasceu do sonho de [contar um pequeno trecho da sua hist√≥ria]. Cada pizza que sai do nosso forno carrega um peda√ßo desse carinho. Obrigado por fazer parte disso! ‚ù§Ô∏è #NossaHistoria #Pizzaria" },
    { title: "Agradecimento aos Clientes", caption: "Nossa maior alegria √© fazer parte dos seus momentos. Obrigado por escolher a D'Italia Pizzaria para fazer sua noite mais feliz! üôè‚ù§Ô∏è #Gratidao #Clientes" },
    { title: "Funcionamento e Contato", caption: "J√° estamos a todo vapor! üî• Pe√ßa sua pizza das 18h √†s 23h. üìû WhatsApp: [Seu N√∫mero] | üíª Site: [Link na Bio]. #HorarioDeFuncionamento #Delivery" },
    { title: "Convidando para Seguir", caption: "Gostou do que viu? Siga nosso perfil para n√£o perder nenhuma novidade, promo√ß√£o ou del√≠cia que postamos por aqui! üòâ #SigaNos #Novidades" },
    { title: "Conhe√ßa o Pizzaiolo", caption: "Conhe√ßa o mestre por tr√°s da magia! ‚ú® Este √© o [Nome do Pizzaiolo], o respons√°vel por transformar ingredientes em pura felicidade. D√™ um oi pra ele nos coment√°rios! #Pizzaiolo #NossaEquipe #Bastidores" },
    { title: "Nossa Equipe de Entrega", caption: "Eles voam pelas ruas pra levar sua pizza quentinha at√© voc√™! üõµüí® Um salve para nossa incr√≠vel equipe de entregadores! #EquipeDeEntrega #DeliveryRapido #Her√≥isDaNoite" },
    { title: "Higiene e Cuidado", caption: "Sua seguran√ßa √© nossa prioridade. Seguimos todos os protocolos de higiene para que voc√™ possa aproveitar sua pizza com tranquilidade e confian√ßa. #SegurancaAlimentar #Cuidado #Confianca" },
    { title: "Estamos no iFood/App", caption: "Al√©m do nosso site e WhatsApp, voc√™ tamb√©m nos encontra no [iFood/outro app]! Procure por D'Italia Pizzaria e fa√ßa seu pedido. #iFood #AppDeDelivery" },
    { title: "Compromisso com a Cidade", caption: "Somos daqui, de Ca√ßapava com orgulho! ‚ù§Ô∏è Agradecemos a todos da nossa cidade por nos receberem t√£o bem e fazerem parte da nossa hist√≥ria. #Ca√ßapava #OrgulhoLocal #ComercioLocal" },
    { title: "Avalie nosso Atendimento", caption: "Sua opini√£o √© muito importante! J√° nos avaliou no Google? Sua avalia√ß√£o nos ajuda a crescer e a melhorar sempre. O link est√° em nosso perfil! ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê #Avaliacao #Feedback #GoogleReviews" },

    // Sazonal e Datas Comemorativas (10)
    { title: "Dia dos Namorados", caption: "Declare seu amor em fatias! ‚ù§Ô∏èüçï Surpreenda seu par com uma noite especial e a melhor pizza da cidade. O amor est√° no ar... e no forno! #DiaDosNamorados #JantarRomantico #PizzaEAmor" },
    { title: "Festa Junina / Julina", caption: "Arrai√° em casa? B√£o demais, s√¥! ü§† E pra ficar mi√≥ ainda, s√≥ com uma pizza da D'Italia pra acompanhar a festan√ßa. Anarri√™! #FestaJunina #PizzaNoArraia #ComidaTipica" },
    { title: "Inverno / Frio", caption: "O friozinho chegou e a pedida perfeita √© uma pizza quentinha no conforto do seu lar. ü•∂üçï Pe√ßa a sua e se aque√ßa com muito sabor! #Inverno #NoiteFria #ComidaDeInverno" },
    { title: "Ver√£o / Calor", caption: "Ver√£o combina com praticidade! Deixe o fog√£o de lado e pe√ßa uma pizza leve e saborosa para aproveitar a noite. ‚òÄÔ∏è #Ver√£o #NoiteDeVerao #PizzaLeve" },
    { title: "Dia das M√£es", caption: "Hoje, a rainha da casa n√£o vai para a cozinha! üëë Surpreenda sua m√£e com um jantar especial da D'Italia. Ela merece todo o sabor e carinho do mundo. #DiaDasMaes #AlmocoDeMae #AmorDeMae" },
    { title: "Dia dos Pais", caption: "O paiz√£o merece o melhor! Que tal comemorar o dia dele com a pizza que ele mais ama? Fa√ßa seu pedido e celebre em fam√≠lia. #DiaDosPais #PresenteParaPai #PaiHeroi" },
    { title: "Natal / Fim de Ano", caption: "Na correria das festas de fim de ano, deixe a janta com a gente! üéÑüçï Uma pausa saborosa para recarregar as energias. Boas festas! #Natal #FimDeAno #Ceia" },
    { title: "Halloween", caption: "Gostosuras ou travessuras? Na D'Italia, a gente garante as gostosuras! üéÉüëª Pe√ßa sua pizza e tenha uma noite de Halloween deliciosamente assustadora. #Halloween #GostosurasOuTravessuras" },
    { title: "Dia da Pizza (10 de Julho)", caption: "HOJE √â O DIA DELA! ü•≥ Dia 10 de Julho, Dia da Pizza! E para comemorar, todas as pizzas com 10% de desconto. Venha celebrar com a gente! #DiaDaPizza #PizzaDay #Comemoracao" },
    { title: "Black Friday", caption: "BLACK FRIDAY D'ITALIA! üñ§üçï Fique de olho nas nossas ofertas imperd√≠veis que v√£o rolar durante a semana. Ative as notifica√ß√µes para n√£o perder nada! #BlackFriday #Descontos #PizzaBarata" },

    // Conte√∫do Adicional (50 novas ideias)
    { title: "O poder do or√©gano", caption: "Voc√™ sabia que o or√©gano n√£o √© s√≥ para dar sabor? Ele tem propriedades antioxidantes! Mais um motivo para amar sua pizza. #Or√©gano #Curiosidades #Ingredientes" },
    { title: "Massa: Fina ou Grossa?", caption: "A eterna d√∫vida: voc√™ prefere massa fina e crocante ou grossa e macia? Conta pra gente qual √© a sua favorita! #MassaDePizza #Enquete #Crocante" },
    { title: "Para os amantes de pimenta", caption: "Gosta de um sabor picante? üå∂Ô∏è Pe√ßa nosso azeite apimentado e d√™ aquele toque especial na sua pizza. #Pimenta #Picante #SaborIntenso" },
    { title: "A hist√≥ria da Calabresa", caption: "Um cl√°ssico √© um cl√°ssico! A pizza de calabresa √© uma das mais amadas no Brasil. Sabia que ela √© uma inven√ß√£o brasileira? #Calabresa #PizzaBrasileira #Hist√≥ria" },
    { title: "Planeje sua festa", caption: "Planejando um anivers√°rio ou uma reuni√£o? Deixe a comida por nossa conta! Entre em contato para pedidos grandes e condi√ß√µes especiais. #FestaComPizza #Aniversario #Eventos" },
    { title: "Meia a Meia Perfeita", caption: "A arte de combinar dois sabores em uma s√≥ pizza. Qual √© a sua dupla de 'meia a meia' perfeita? Compartilhe suas ideias! #MeioAMeio #Combina√ß√£oPerfeita" },
    { title: "O cheiro inconfund√≠vel", caption: "Aquele cheirinho de pizza saindo do forno que melhora qualquer dia. J√° sentiu hoje? #CheiroDePizza #Felicidade #Aroma" },
    { title: "Combate √† fome da madrugada", caption: "Aquela fome que bate fora de hora? Estamos aqui pra resolver! Confira nosso hor√°rio e pe√ßa sua pizza. #FomeNaMadrugada #DeliveryNoturno" },
    { title: "Pizza e Trabalho", caption: "Trabalhando at√© mais tarde? D√™ um g√°s na sua produtividade com uma pausa para a melhor pizza. Voc√™ merece! #PizzaNoTrabalho #Pausa #Energia" },
    { title: "Presenteie com Pizza", caption: "Quer alegrar o dia de algu√©m? Mande uma pizza de presente! √â a prova de amizade e carinho mais saborosa que existe. #PresenteCriativo #Surpresa" },
    { title: "O dilema da √∫ltima fatia", caption: "A √∫ltima fatia: se divide ou quem viu primeiro leva? Marque aqui quem sempre pega o √∫ltimo peda√ßo! üòÇ #UltimaFatia #Brincadeira #Amigos" },
    { title: "Nossa gratid√£o", caption: "Cada pedido √© uma nova hist√≥ria. Somos muito gratos por fazer parte das suas noites. Obrigado pela confian√ßa! #Gratid√£o #Comunidade" },
    { title: "Foco no molho de tomate", caption: "A base de tudo: nosso molho de tomate √© feito com tomates selecionados e um tempero especial da casa. Sinta a diferen√ßa! #MolhoDeTomate #ReceitaSecreta" },
    { title: "Pizza fria no dia seguinte?", caption: "O caf√© da manh√£ dos campe√µes! Quem a√≠ tamb√©m ama uma fatia de pizza fria no dia seguinte? Confesse! üòã #PizzaFria #Caf√©DaManh√£" },
    { title: "Como reaquecer sua pizza", caption: "Dica de ouro: para sua pizza parecer que acabou de sair do forno, reaque√ßa na frigideira! Fica crocante e deliciosa. #Dica #ReaquecerPizza" },
    { title: "A import√¢ncia do forno", caption: "Nosso forno trabalha em alta temperatura para garantir uma massa perfeitamente assada e um queijo derretido no ponto certo. üî• #FornoDePizza #Segredo" },
    { title: "Pedido para a fam√≠lia toda", caption: "Tem pizza para todos os gostos! Da crian√ßada aos av√≥s, nosso card√°pio tem o sabor que agrada a fam√≠lia inteira. #PizzaEmFamilia #JantarDeFamilia" },
    { title: "Dia do Amigo", caption: "Feliz Dia do Amigo! E para comemorar, que tal uma pizza? Marque seus amigos e combine a celebra√ß√£o! #DiaDoAmigo #Amizade" },
    { title: "Nosso compromisso com a entrega", caption: "Trabalhamos para que sua pizza chegue quentinha e perfeita. Nossa equipe de entrega √© treinada para ter o m√°ximo cuidado com seu pedido. #EntregaDeQualidade" },
    { title: "A pizza que abra√ßa", caption: "Tem dias que a gente s√≥ precisa de um abra√ßo... em forma de pizza. Pe√ßa a sua e sinta esse conforto. #ComfortFood #ComidaQueAbraca" },
    { title: "Sabor que te transporta", caption: "Feche os olhos e sinta o sabor da It√°lia. Nossas receitas s√£o inspiradas na tradi√ß√£o para te levar em uma viagem de sabores. üáÆüáπ #SaborDaItalia #TradicaoItaliana" },
    { title: "Fim de m√™s", caption: "Fim de m√™s apertado mas a vontade de pizza √© grande? Fique de olho nas nossas promo√ß√µes e cupons! #FimDeMes #Economia" },
    { title: "Use nosso App/Site", caption: "J√° experimentou pedir pelo nosso site/app? √â mais r√°pido, f√°cil e voc√™ ainda participa do nosso programa de fidelidade! #Tecnologia #AppDeDelivery" },
    { title: "Programa de Fidelidade", caption: "Aqui, sua fidelidade vira pizza! üçï A cada pedido, voc√™ acumula pontos para trocar por descontos. J√° conferiu quantos pontos voc√™ tem? #Fidelidade #Pontos #Desconto" },
    { title: "Pizza e Netflix", caption: "O 'match' perfeito para sua noite. Qual s√©rie voc√™ est√° maratonando com a sua D'Italia hoje? #PizzaeNetflix #MaratonaDeSeries" },
    { title: "O cl√°ssico: Margherita", caption: "Simples, cl√°ssica e perfeita. A pizza Margherita √© a rainha das pizzas e uma homenagem √† It√°lia. Pe√ßa esse cl√°ssico! #Margherita #PizzaClassica" },
    { title: "Ouse no sabor!", caption: "Que tal sair da rotina hoje? Experimente um sabor que voc√™ nunca pediu! Navegue pelo nosso card√°pio e descubra novas paix√µes. #Experimente #NovosSabores" },
    { title: "Para os fortes: Pizza de Alho", caption: "Para quem n√£o tem medo de um sabor marcante! Nossa pizza de alho √© para os fortes. E a√≠, encara? üòâ #PizzaDeAlho #SaborForte" },
    { title: "O Doce e o Salgado", caption: "Quem disse que n√£o pode ter os dois? Comece com sua pizza salgada favorita e finalize com uma de nossas del√≠cias doces. #DoceESalgado #Sobremesa" },
    { title: "O que dizem sobre n√≥s", caption: "'A entrega foi super r√°pida e a pizza estava divina!' - [Nome do Cliente]. Adoramos o seu feedback! Deixe sua avalia√ß√£o tamb√©m. #Depoimento #ClienteSatisfeito" },
    { title: "Seu pedido est√° a caminho!", caption: "S√≥ para te deixar com mais vontade: seu pedido j√° est√° sendo preparado e logo logo chega a√≠! üòâ Acompanhe o status em tempo real no nosso site. #StatusDoPedido #AoVivo" },
    { title: "A pizza da sua selfie", caption: "Nossas pizzas n√£o s√£o s√≥ gostosas, s√£o fotog√™nicas! Poste uma selfie com a sua e marque a gente! üì∏ #PizzaGram #Instafood" },
    { title: "Borda infinita", caption: "Para os amantes de borda, aqui ela √© sempre generosa e crocante. Qual a sua parte favorita da pizza? #Borda #Crocante" },
    { title: "Anivers√°rio na D'Italia", caption: "Fazendo anivers√°rio? Comemore com a gente! Pedidos acima de [valor] ganham um [brinde/desconto] especial. #Aniversario #Comemoracao" },
    { title: "Dia chuvoso", caption: "A chuva l√° fora, e o cheirinho de pizza aqui dentro. O cen√°rio perfeito! Pe√ßa seu delivery. #Chuva #Delivery" },
    { title: "Pr√©-balada", caption: "O esquenta perfeito para a sua noite come√ßa aqui! Re√∫na os amigos para uma pizza antes da festa. #Esquenta #PreBalada" },
    { title: "Feriado", caption: "Feriado √© sin√¥nimo de descanso. E descanso combina com pizza! Estamos funcionando normalmente hoje. #Feriado #PizzaNoFeriado" },
    { title: "O debate do abacaxi", caption: "Vamos resolver isso de uma vez por todas: abacaxi na pizza, sim ou n√£o? Comente sua opini√£o! üçç #AbacaxiNaPizza #Debate" },
    { title: "Para os veganos", caption: "Temos op√ß√µes deliciosas para todos! Conhe√ßa nossa pizza vegana, feita com queijo √† base de plantas e muito sabor. #Vegano #PizzaVegana" },
    { title: "Seu conforto em uma caixa", caption: "Mais que uma refei√ß√£o, uma caixa cheia de conforto e sabor esperando por voc√™. Pe√ßa seu momento D'Italia. #Conforto #Carinho" },
    { title: "Aten√ß√£o aos detalhes", caption: "Do corte preciso dos ingredientes √† embalagem cuidadosa, pensamos em cada detalhe para sua experi√™ncia ser perfeita. #Detalhes #Qualidade" },
    { title: "Contra a fome de segunda", caption: "A gente sabe que a segunda pode ser dif√≠cil. Mas ela fica bem melhor quando termina em pizza. #X√¥Segunda #PizzaTerapia" },
    { title: "O poder da mussarela", caption: "A base de quase tudo, nossa mussarela √© de alta qualidade, garantindo aquele derretimento perfeito e sabor inigual√°vel. #Mussarela #Queijo" },
    { title: "Final de expediente", caption: "Fim do expediente, come√ßo do relaxamento. Deixe a gente cuidar do seu jantar hoje. Voc√™ merece. #FimDeExpediente #Relax" },
    { title: "Um presente para voc√™", caption: "√Äs vezes, a gente precisa se presentear. E qual presente √© melhor que uma pizza quentinha? #Mimo #AutoCuidado" },
    { title: "A escolha da fam√≠lia", caption: "Quando a fam√≠lia n√£o consegue decidir o que comer, a pizza une todo mundo! Pe√ßa v√°rios sabores e agrade a todos. #Familia #Uniao" },
    { title: "Sabor local", caption: "Apoiando o com√©rcio local, voc√™ fortalece nossa cidade e ainda come a melhor pizza! Obrigado por escolher a gente. #ComercioLocal #Ca√ßapava" },
    { title: "Acompanhe nosso trabalho", caption: "Quer ver mais dos nossos bastidores e promo√ß√µes? Ative as notifica√ß√µes do nosso perfil e n√£o perca nada! #Notifica√ß√µes #FiquePorDentro" },
    { title: "Pe√ßa e retire", caption: "Passando perto da gente? Fa√ßa seu pedido pelo site ou WhatsApp e escolha a op√ß√£o 'Retirar no Balc√£o' para n√£o pegar fila! #Pe√ßaERetire #Praticidade" },
];


// Fun√ß√£o principal de inicializa√ß√£o da se√ß√£o
async function initializeMarketingSection() {
    if (marketingSectionInitialized) return;
    marketingSectionInitialized = true;
    console.log("M√≥dulo Marketing.js: Inicializando...");

    const marketingForm = document.getElementById('marketing-form');
    const formTitle = document.getElementById('marketing-form-title');
    const postIdInput = document.getElementById('marketing-post-id');
    const postTitleInput = document.getElementById('post-title');
    const postCaptionInput = document.getElementById('post-caption');
    const postScheduledAtInput = document.getElementById('post-scheduled-at');
    const cancelEditBtn = document.getElementById('cancel-edit-post-btn');
    const scheduledPostsContainer = document.getElementById('scheduled-posts-container');
    const openIdeasBtn = document.getElementById('open-caption-ideas-btn');
    const ideasModal = document.getElementById('caption-ideas-modal');
    const ideasListContainer = document.getElementById('caption-ideas-list');
    
    if (ideasListContainer) {
        ideasListContainer.innerHTML = CAPTION_IDEAS.map(idea => `
            <div class="idea-item">
                <h4>${idea.title}</h4>
                <p>${idea.caption.replace(/\n/g, "<br>")}</p>
                <button class="btn btn-sm btn-primary use-caption-btn">Usar esta legenda</button>
            </div>
        `).join('<hr class="idea-separator">');
    }

    if (openIdeasBtn) {
        openIdeasBtn.addEventListener('click', () => ideasModal.classList.add('show'));
    }
    if (ideasModal) {
        ideasModal.querySelector('.close-modal-btn').addEventListener('click', () => ideasModal.classList.remove('show'));
    }

    ideasListContainer.querySelectorAll('.use-caption-btn').forEach((button, index) => {
        button.addEventListener('click', () => {
            postCaptionInput.value = CAPTION_IDEAS[index].caption;
            ideasModal.classList.remove('show');
            postCaptionInput.focus();
        });
    });

    function loadScheduledPosts() {
        const { collection, query, where, onSnapshot, orderBy } = window.firebaseFirestore;
        const q = query(collection(window.db, MARKETING_COLLECTION), where("status", "==", "agendado"), orderBy("scheduledAt", "asc"));

        onSnapshot(q, (snapshot) => {
            if (snapshot.empty) {
                scheduledPostsContainer.innerHTML = '<p class="empty-list-message">Nenhuma postagem agendada.</p>';
                return;
            }
            const posts = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
            renderScheduledPosts(posts);
        });
    }

    function renderScheduledPosts(posts) {
        scheduledPostsContainer.innerHTML = posts.map(post => {
            const scheduleDate = post.scheduledAt.toDate();
            const formattedDate = scheduleDate.toLocaleString('pt-BR', { dateStyle: 'short', timeStyle: 'short' });
            return `
                <div class="scheduled-post-card">
                    <div class="post-details">
                        <strong class="post-title">${post.title}</strong>
                        <span class="post-time"><i class="fas fa-clock"></i> ${formattedDate}</span>
                        <p class="post-caption-preview">${post.caption.substring(0, 100)}...</p>
                    </div>
                    <div class="post-actions">
                        <button class="btn-icon edit-post-btn" data-id="${post.id}" title="Editar"><i class="fas fa-edit"></i></button>
                        <button class="btn-icon btn-danger-outline delete-post-btn" data-id="${post.id}" title="Cancelar Agendamento"><i class="fas fa-trash-alt"></i></button>
                    </div>
                </div>
            `;
        }).join('');
        addPostActionListeners();
    }
    
    function addPostActionListeners() {
        scheduledPostsContainer.querySelectorAll('.edit-post-btn').forEach(button => {
            button.addEventListener('click', async (e) => {
                const docId = e.target.closest('button').dataset.id;
                const { doc, getDoc } = window.firebaseFirestore;
                const postSnap = await getDoc(doc(window.db, MARKETING_COLLECTION, docId));
                if (postSnap.exists()) {
                    const post = postSnap.data();
                    formTitle.textContent = "Editar Agendamento";
                    postIdInput.value = docId;
                    postTitleInput.value = post.title;
                    postCaptionInput.value = post.caption;
                    const date = post.scheduledAt.toDate();
                    date.setMinutes(date.getMinutes() - date.getTimezoneOffset());
                    postScheduledAtInput.value = date.toISOString().slice(0,16);
                    cancelEditBtn.classList.remove('hidden');
                    window.scrollTo(0, 0);
                }
            });
        });

        scheduledPostsContainer.querySelectorAll('.delete-post-btn').forEach(button => {
            button.addEventListener('click', async (e) => {
                const docId = e.target.closest('button').dataset.id;
                if (confirm("Tem certeza que deseja cancelar este agendamento?")) {
                    const { doc, deleteDoc } = window.firebaseFirestore;
                    await deleteDoc(doc(window.db, MARKETING_COLLECTION, docId));
                    window.showToast("Agendamento cancelado.", "success");
                }
            });
        });
    }

    marketingForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const { doc, collection, addDoc, updateDoc, Timestamp } = window.firebaseFirestore;
        
        const postData = {
            title: postTitleInput.value,
            caption: postCaptionInput.value,
            scheduledAt: Timestamp.fromDate(new Date(postScheduledAtInput.value)),
            status: 'agendado'
        };

        const postId = postIdInput.value;
        if (postId) {
            await updateDoc(doc(window.db, MARKETING_COLLECTION, postId), postData);
            window.showToast("Agendamento atualizado!", "success");
        } else {
            await addDoc(collection(window.db, MARKETING_COLLECTION), postData);
            window.showToast("Post agendado com sucesso!", "success");
        }
        
        marketingForm.reset();
        formTitle.textContent = "Agendar Nova Postagem";
        postIdInput.value = '';
        cancelEditBtn.classList.add('hidden');
    });

    cancelEditBtn.addEventListener('click', () => {
        marketingForm.reset();
        formTitle.textContent = "Agendar Nova Postagem";
        postIdInput.value = '';
        cancelEditBtn.classList.add('hidden');
    });

    loadScheduledPosts();
}

window.initializeMarketingSection = initializeMarketingSection;